#pragma once

#include "types.hpp"
#include <cassert>

#define SFFT_NMAX 16

template<class T>
void fft_complex_2(T* x) {
	T rr0;
	T rr1;
	T rr2;
	rr0 = x[0];
	x[0] = rr0 + x[2];
	rr1 = x[1];
	x[1] = rr1 + x[3];
	rr2 = x[2];
	x[2] = rr0 - rr2;
	rr0 = x[3];
	x[3] = rr1 - rr0;
}

template<class T>
void fft_complex_3(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 4.99999999999999778e-01;
	const T c1 = 8.66025403784438708e-01;
	rr0 = x[2] + x[4];
	rr1 = x[3] + x[5];
	x[2] -= x[4];
	x[3] -= x[5];
	x[4] = x[0];
	x[0] = rr0 + x[4];
	x[5] = x[1];
	x[1] = rr1 + x[5];
	rr0 *= c0;
	x[4] -= rr0;
	rr1 *= c0;
	x[5] -= rr1;
	x[3] *= c1;
	x[2] *= c1;
	rr0 = x[2];
	x[2] = x[3] + x[4];
	rr1 = x[3];
	x[3] = x[5] - rr0;
	rr2 = x[4];
	x[4] = rr2 - rr1;
	rr1 = x[5];
	x[5] = rr0 + rr1;
}

template<class T>
void fft_complex_4(T* x) {
	T rr0;
	T rr1;
	T rr2;
	rr0 = x[0] + x[4];
	rr1 = x[1] + x[5];
	x[0] -= x[4];
	x[1] -= x[5];
	x[4] = x[2] + x[6];
	x[5] = x[3] + x[7];
	x[2] -= x[6];
	x[3] -= x[7];
	x[6] = x[0];
	x[0] = rr0 + x[4];
	x[7] = x[1];
	x[1] = rr1 + x[5];
	rr2 = x[4];
	x[4] = rr0 - rr2;
	rr0 = x[5];
	x[5] = rr1 - rr0;
	rr0 = x[2];
	x[2] = x[6] + x[3];
	rr1 = x[3];
	x[3] = x[7] - rr0;
	rr2 = x[6];
	x[6] = rr2 - rr1;
	rr1 = x[7];
	x[7] = rr0 + rr1;
}

template<class T>
void fft_complex_5(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 5.59016994374947451e-01;
	const T c1 = 2.49999999999999944e-01;
	const T c2 = 5.87785252292473248e-01;
	const T c3 = 9.51056516295153531e-01;
	rr0 = x[2] + x[8];
	rr1 = x[3] + x[9];
	x[2] -= x[8];
	x[3] -= x[9];
	x[8] = x[4] + x[6];
	x[9] = x[5] + x[7];
	x[4] -= x[6];
	x[5] -= x[7];
	x[6] = rr0 - x[8];
	x[6] *= c0;
	rr0 += x[8];
	x[7] = rr0 * c1;
	x[7] = x[0] - x[7];
	x[8] = x[7] + x[6];
	x[7] -= x[6];
	x[6] = rr1 - x[9];
	x[6] *= c0;
	rr1 += x[9];
	x[9] = rr1 * c1;
	x[9] = x[1] - x[9];
	rr2 = x[9] + x[6];
	x[9] -= x[6];
	x[6] = x[0];
	x[0] = rr0 + x[6];
	rr0 = x[1];
	x[1] = rr1 + rr0;
	rr0 = x[5] * c2;
	rr1 = x[3] * c3;
	rr1 += rr0;
	rr0 = x[4] * c2;
	x[6] = x[2] * c3;
	x[6] += rr0;
	x[3] *= c2;
	x[5] *= c3;
	x[5] -= x[3];
	x[2] *= c2;
	x[4] *= c3;
	x[4] -= x[2];
	x[2] = rr1 + x[8];
	x[3] = rr2 - x[6];
	rr0 = x[8];
	x[8] = rr0 - rr1;
	rr0 = x[9];
	x[9] = x[6] + rr2;
	rr1 = x[4];
	x[4] = x[7] - x[5];
	rr2 = x[5];
	x[5] = rr0 + rr1;
	x[6] = x[7] + rr2;
	x[7] = rr0 - rr1;
}

template<class T>
void fft_complex_6(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 4.99999999999999778e-01;
	const T c1 = 8.66025403784438708e-01;
	rr0 = x[4] + x[8];
	rr1 = x[5] + x[9];
	x[4] -= x[8];
	x[5] -= x[9];
	x[8] = rr0 + x[0];
	x[9] = rr1 + x[1];
	rr0 *= c0;
	x[0] -= rr0;
	rr1 *= c0;
	x[1] -= rr1;
	x[5] *= c1;
	x[4] *= c1;
	rr0 = x[5] + x[0];
	rr1 = x[1] - x[4];
	x[0] -= x[5];
	x[4] += x[1];
	x[1] = x[10] + x[2];
	x[5] = x[11] + x[3];
	x[10] -= x[2];
	x[11] -= x[3];
	x[2] = x[1] + x[6];
	x[3] = x[5] + x[7];
	x[1] *= c0;
	x[6] -= x[1];
	x[5] *= c0;
	x[7] -= x[5];
	x[11] *= c1;
	x[10] *= c1;
	x[1] = x[11] + x[6];
	x[5] = x[7] - x[10];
	x[6] -= x[11];
	x[10] += x[7];
	x[11] = x[0];
	x[0] = x[8] + x[2];
	x[7] = x[1];
	x[1] = x[9] + x[3];
	rr2 = x[6];
	x[6] = x[8] - x[2];
	x[2] = x[7];
	x[7] = x[9] - x[3];
	x[8] = rr0 + x[2];
	x[9] = rr1 + x[5];
	x[3] = x[2];
	x[2] = rr0 - x[3];
	x[3] = rr1 - x[5];
	rr0 = x[4];
	x[4] = x[11] + rr2;
	x[5] = rr0 + x[10];
	rr1 = x[10];
	x[10] = x[11] - rr2;
	x[11] = rr0 - rr1;
}

template<class T>
void fft_complex_7(T* x) {
	T rr0;
	T rr1;
	T rr2;
	T rr3;
	T rr4;
	T rr5;
	T rr6;
	const T c0 = 9.00968867902419035e-01;
	const T c1 = 2.22520933956314337e-01;
	const T c2 = 6.23489801858733594e-01;
	const T c3 = 4.33883739117558231e-01;
	const T c4 = 9.74927912181823619e-01;
	const T c5 = 7.81831482468029804e-01;
	rr0 = x[2] + x[12];
	rr1 = x[3] + x[13];
	x[2] -= x[12];
	x[3] -= x[13];
	x[12] = x[4] + x[10];
	x[13] = x[5] + x[11];
	x[4] -= x[10];
	x[5] -= x[11];
	x[10] = x[6] + x[8];
	x[11] = x[7] + x[9];
	x[6] -= x[8];
	x[7] -= x[9];
	x[8] = rr0 + x[12];
	x[8] += x[10];
	x[9] = x[0];
	x[0] = x[8] + x[9];
	x[8] = rr1 + x[13];
	x[8] += x[11];
	rr2 = x[1];
	x[1] = x[8] + rr2;
	x[8] = x[10] * c0;
	rr3 = x[12] * c1;
	rr4 = rr0 * c2;
	rr4 -= rr3;
	rr4 -= x[8];
	rr4 += x[9];
	rr3 = x[11] * c0;
	x[8] = x[13] * c1;
	rr5 = rr1 * c2;
	rr5 -= x[8];
	rr5 -= rr3;
	rr5 += rr2;
	rr3 = x[12] * c0;
	x[8] = rr0 * c1;
	x[8] += rr3;
	rr3 = x[10] * c2;
	rr3 -= x[8];
	rr3 += x[9];
	x[8] = x[13] * c0;
	rr6 = rr1 * c1;
	rr6 += x[8];
	x[8] = x[11] * c2;
	x[8] -= rr6;
	x[8] += rr2;
	x[10] *= c1;
	rr0 *= c0;
	x[12] *= c2;
	x[12] -= rr0;
	x[12] -= x[10];
	x[12] += x[9];
	x[11] *= c1;
	rr1 *= c0;
	x[13] *= c2;
	x[13] -= rr1;
	x[13] -= x[11];
	x[13] += rr2;
	rr0 = x[7] * c3;
	rr1 = x[5] * c4;
	rr2 = x[3] * c5;
	rr2 += rr1;
	rr2 += rr0;
	rr0 = x[6] * c3;
	rr1 = x[4] * c4;
	rr6 = x[2] * c5;
	rr6 += rr1;
	rr6 += rr0;
	rr0 = x[3] * c4;
	rr1 = x[5] * c3;
	rr1 -= rr0;
	rr0 = x[7] * c5;
	rr0 += rr1;
	rr1 = x[2] * c4;
	x[10] = x[4] * c3;
	x[10] -= rr1;
	rr1 = x[6] * c5;
	rr1 += x[10];
	x[7] *= c4;
	x[3] *= c3;
	x[5] *= c5;
	x[5] -= x[3];
	x[5] -= x[7];
	x[6] *= c4;
	x[2] *= c3;
	x[4] *= c5;
	x[4] -= x[2];
	x[4] -= x[6];
	x[2] = rr2 + rr4;
	x[3] = rr5 - rr6;
	x[10] = x[12];
	x[12] = rr4 - rr2;
	rr2 = x[13];
	x[13] = rr6 + rr5;
	rr4 = x[4];
	x[4] = rr3 - rr0;
	rr5 = x[5];
	x[5] = x[8] + rr1;
	rr6 = x[10];
	x[10] = rr3 + rr0;
	x[11] = x[8] - rr1;
	x[6] = rr6 - rr5;
	x[7] = rr2 + rr4;
	x[8] = rr6 + rr5;
	x[9] = rr2 - rr4;
}

template<class T>
void fft_complex_8(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 7.07106781186547573e-01;
	rr0 = x[0] + x[8];
	rr1 = x[1] + x[9];
	x[0] -= x[8];
	x[1] -= x[9];
	x[8] = x[4] + x[12];
	x[9] = x[5] + x[13];
	x[4] -= x[12];
	x[5] -= x[13];
	x[12] = rr0 + x[8];
	x[13] = rr1 + x[9];
	rr0 -= x[8];
	rr1 -= x[9];
	x[8] = x[0] + x[5];
	x[9] = x[1] - x[4];
	x[0] -= x[5];
	x[4] += x[1];
	x[1] = x[2] + x[10];
	x[5] = x[3] + x[11];
	x[2] -= x[10];
	x[3] -= x[11];
	x[10] = x[6] + x[14];
	x[11] = x[7] + x[15];
	x[6] -= x[14];
	x[7] -= x[15];
	x[14] = x[1] + x[10];
	x[15] = x[5] + x[11];
	x[1] -= x[10];
	x[5] -= x[11];
	x[10] = x[2] + x[7];
	x[11] = x[3] - x[6];
	x[2] -= x[7];
	x[6] += x[3];
	x[10] *= c0;
	x[11] *= c0;
	x[3] = x[11] + x[10];
	x[11] -= x[10];
	x[2] *= c0;
	x[6] *= c0;
	x[10] = x[6] - x[2];
	x[2] += x[6];
	x[6] = x[0];
	x[0] = x[12] + x[14];
	x[7] = x[1];
	x[1] = x[13] + x[15];
	rr2 = x[8];
	x[8] = x[12] - x[14];
	x[12] = x[9];
	x[9] = x[13] - x[15];
	x[13] = x[2];
	x[2] = rr2 + x[3];
	x[14] = x[3];
	x[3] = x[12] + x[11];
	x[15] = x[10];
	x[10] = rr2 - x[14];
	rr2 = x[11];
	x[11] = x[12] - rr2;
	rr2 = x[4];
	x[4] = rr0 + x[5];
	x[12] = x[5];
	x[5] = rr1 - x[7];
	x[14] = x[12];
	x[12] = rr0 - x[14];
	rr0 = x[13];
	x[13] = x[7] + rr1;
	rr1 = x[6];
	x[6] = rr1 + x[15];
	x[7] = rr2 - rr0;
	x[14] = rr1 - x[15];
	x[15] = rr0 + rr2;
}

template<class T>
void fft_complex_9(T* x) {
	T rr0;
	T rr1;
	T rr2;
	T rr3;
	T rr4;
	const T c0 = 4.99999999999999778e-01;
	const T c1 = 8.66025403784438708e-01;
	const T c2 = 6.42787609686539252e-01;
	const T c3 = 7.66044443118978013e-01;
	const T c4 = 3.42020143325668879e-01;
	const T c5 = 9.39692620785908317e-01;
	const T c6 = 9.84807753012208020e-01;
	const T c7 = 1.73648177666930414e-01;
	rr0 = x[6] + x[12];
	rr1 = x[7] + x[13];
	x[6] -= x[12];
	x[7] -= x[13];
	x[12] = rr0 + x[0];
	x[13] = rr1 + x[1];
	rr0 *= c0;
	x[0] -= rr0;
	rr1 *= c0;
	x[1] -= rr1;
	x[7] *= c1;
	x[6] *= c1;
	rr0 = x[7] + x[0];
	rr1 = x[1] - x[6];
	x[0] -= x[7];
	x[6] += x[1];
	x[1] = x[8] + x[14];
	x[7] = x[9] + x[15];
	x[8] -= x[14];
	x[9] -= x[15];
	x[14] = x[1] + x[2];
	x[15] = x[7] + x[3];
	x[1] *= c0;
	x[2] -= x[1];
	x[7] *= c0;
	x[3] -= x[7];
	x[9] *= c1;
	x[8] *= c1;
	x[1] = x[9] + x[2];
	x[7] = x[3] - x[8];
	x[2] -= x[9];
	x[8] += x[3];
	x[3] = x[4] + x[10];
	x[9] = x[5] + x[11];
	x[4] -= x[10];
	x[5] -= x[11];
	x[10] = x[3] + x[16];
	x[11] = x[9] + x[17];
	x[3] *= c0;
	x[16] -= x[3];
	x[9] *= c0;
	x[17] -= x[9];
	x[5] *= c1;
	x[4] *= c1;
	x[3] = x[5] + x[16];
	x[9] = x[17] - x[4];
	x[16] -= x[5];
	x[4] += x[17];
	x[17] = x[11] - x[15];
	x[17] *= c1;
	x[5] = x[14] + x[10];
	rr2 = c0 * x[5];
	rr2 = x[12] - rr2;
	rr3 = x[12];
	x[12] = rr2 + x[17];
	x[14] -= x[10];
	x[14] *= c1;
	x[15] += x[11];
	x[10] = c0 * x[15];
	x[10] = x[13] - x[10];
	x[11] = x[13];
	x[13] = x[10] + x[14];
	rr4 = x[0];
	x[0] = rr3 + x[5];
	rr3 = x[1];
	x[1] = x[11] + x[15];
	x[11] = x[6];
	x[6] = rr2 - x[17];
	rr2 = x[7];
	x[7] = x[10] - x[14];
	x[10] = x[9] - rr2;
	x[14] = c2 * x[10];
	x[15] = rr3 + x[3];
	x[17] = c3 * x[15];
	x[17] -= x[14];
	x[14] = x[2];
	x[2] = rr0 + x[17];
	rr3 -= x[3];
	x[3] = c2 * rr3;
	rr2 += x[9];
	x[5] = c3 * rr2;
	x[5] -= x[3];
	x[3] = rr1 + x[5];
	x[10] *= c4;
	x[15] *= c5;
	x[15] += x[10];
	x[10] = x[8];
	x[8] = rr0 - x[15];
	rr3 *= c4;
	rr2 *= c5;
	rr2 += rr3;
	x[9] = rr1 - rr2;
	rr0 -= x[17];
	rr3 = x[14];
	x[14] = x[15] + rr0;
	rr1 -= x[5];
	x[15] = rr2 + rr1;
	rr0 = x[4] - x[10];
	rr1 = c6 * rr0;
	rr2 = rr3 + x[16];
	x[17] = c7 * rr2;
	x[17] -= rr1;
	rr1 = x[4];
	x[4] = rr4 + x[17];
	rr3 -= x[16];
	x[16] = c6 * rr3;
	x[10] += rr1;
	rr1 = c7 * x[10];
	rr1 -= x[16];
	x[5] = x[11] + rr1;
	rr2 *= c5;
	rr0 *= c4;
	rr0 -= rr2;
	rr2 = x[10];
	x[10] = rr4 + rr0;
	rr2 *= c5;
	rr3 *= c4;
	rr3 -= rr2;
	rr2 = x[11];
	x[11] = rr2 + rr3;
	rr4 -= x[17];
	x[16] = rr4 - rr0;
	rr2 -= rr1;
	x[17] = rr2 - rr3;
}

template<class T>
void fft_complex_10(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 5.59016994374947451e-01;
	const T c1 = 2.49999999999999944e-01;
	const T c2 = 5.87785252292473248e-01;
	const T c3 = 9.51056516295153531e-01;
	rr0 = x[4] + x[16];
	rr1 = x[5] + x[17];
	x[4] -= x[16];
	x[5] -= x[17];
	x[16] = x[8] + x[12];
	x[17] = x[9] + x[13];
	x[8] -= x[12];
	x[9] -= x[13];
	x[12] = rr0 - x[16];
	x[12] *= c0;
	rr0 += x[16];
	x[13] = rr0 * c1;
	x[13] = x[0] - x[13];
	x[16] = x[13] + x[12];
	x[13] -= x[12];
	x[12] = rr1 - x[17];
	x[12] *= c0;
	rr1 += x[17];
	x[17] = rr1 * c1;
	x[17] = x[1] - x[17];
	rr2 = x[17] + x[12];
	x[17] -= x[12];
	rr0 += x[0];
	rr1 += x[1];
	x[0] = x[9] * c2;
	x[12] = x[5] * c3;
	x[12] += x[0];
	x[0] = x[8] * c2;
	x[1] = x[4] * c3;
	x[1] += x[0];
	x[5] *= c2;
	x[9] *= c3;
	x[9] -= x[5];
	x[4] *= c2;
	x[8] *= c3;
	x[8] -= x[4];
	x[0] = x[12] + x[16];
	x[4] = rr2 - x[1];
	x[16] -= x[12];
	x[1] += rr2;
	rr2 = x[13] - x[9];
	x[12] = x[17] + x[8];
	x[13] += x[9];
	x[17] -= x[8];
	x[5] = x[14] + x[6];
	x[8] = x[15] + x[7];
	x[14] -= x[6];
	x[15] -= x[7];
	x[6] = x[18] + x[2];
	x[7] = x[19] + x[3];
	x[18] -= x[2];
	x[19] -= x[3];
	x[2] = x[5] - x[6];
	x[2] *= c0;
	x[5] += x[6];
	x[3] = x[5] * c1;
	x[3] = x[10] - x[3];
	x[6] = x[3] + x[2];
	x[3] -= x[2];
	x[2] = x[8] - x[7];
	x[2] *= c0;
	x[8] += x[7];
	x[7] = x[8] * c1;
	x[7] = x[11] - x[7];
	x[9] = x[7] + x[2];
	x[7] -= x[2];
	x[5] += x[10];
	x[8] += x[11];
	x[10] = x[19] * c2;
	x[11] = x[15] * c3;
	x[11] += x[10];
	x[10] = x[18] * c2;
	x[2] = x[14] * c3;
	x[2] += x[10];
	x[15] *= c2;
	x[19] *= c3;
	x[19] -= x[15];
	x[14] *= c2;
	x[18] *= c3;
	x[18] -= x[14];
	x[10] = x[11] + x[6];
	x[14] = x[9] - x[2];
	x[6] -= x[11];
	x[2] += x[9];
	x[11] = x[3] - x[19];
	x[15] = x[7] + x[18];
	x[3] += x[19];
	x[7] -= x[18];
	x[18] = x[0];
	x[0] = rr0 + x[5];
	x[19] = x[1];
	x[1] = rr1 + x[8];
	x[9] = x[10];
	x[10] = rr0 - x[5];
	rr0 = x[11];
	x[11] = rr1 - x[8];
	rr1 = x[12];
	x[12] = x[18] + x[9];
	x[5] = x[13];
	x[13] = x[4] + x[14];
	x[8] = x[2];
	x[2] = x[18] - x[9];
	x[18] = x[3];
	x[3] = x[4] - x[14];
	x[4] = rr2 + rr0;
	x[14] = x[5];
	x[5] = rr1 + x[15];
	x[9] = x[14];
	x[14] = rr2 - rr0;
	rr0 = x[15];
	x[15] = rr1 - rr0;
	rr0 = x[16];
	x[16] = x[9] + x[18];
	rr1 = x[17];
	x[17] = rr1 + x[7];
	rr2 = x[6];
	x[6] = x[9] - x[18];
	x[18] = x[7];
	x[7] = rr1 - x[18];
	rr1 = x[8];
	x[8] = rr0 + rr2;
	x[9] = x[19] + rr1;
	x[18] = rr0 - rr2;
	rr0 = x[19];
	x[19] = rr0 - rr1;
}

template<class T>
void fft_complex_11(T* x) {
	T rr0;
	T rr1;
	T rr2;
	T rr3;
	T rr4;
	T rr5;
	T rr6;
	T rr7;
	T rr8;
	T rr9;
	T rr10;
	T rr11;
	T rr12;
	const T c0 = 9.59492973614497369e-01;
	const T c1 = 6.54860733945284990e-01;
	const T c2 = 1.42314838273285005e-01;
	const T c3 = 4.15415013001886435e-01;
	const T c4 = 8.41253532831181206e-01;
	const T c5 = 2.81732556841429671e-01;
	const T c6 = 7.55749574354258269e-01;
	const T c7 = 9.89821441880932795e-01;
	const T c8 = 9.09631995354518330e-01;
	const T c9 = 5.40640817455597555e-01;
	rr0 = x[2] + x[20];
	rr1 = x[3] + x[21];
	x[2] -= x[20];
	x[3] -= x[21];
	x[20] = x[4] + x[18];
	x[21] = x[5] + x[19];
	x[4] -= x[18];
	x[5] -= x[19];
	x[18] = x[6] + x[16];
	x[19] = x[7] + x[17];
	x[6] -= x[16];
	x[7] -= x[17];
	x[16] = x[8] + x[14];
	x[17] = x[9] + x[15];
	x[8] -= x[14];
	x[9] -= x[15];
	x[14] = x[10] + x[12];
	x[15] = x[11] + x[13];
	x[10] -= x[12];
	x[11] -= x[13];
	x[12] = rr0 + x[20];
	x[12] += x[18];
	x[12] += x[16];
	x[12] += x[14];
	x[13] = x[0];
	x[0] = x[12] + x[13];
	x[12] = rr1 + x[21];
	x[12] += x[19];
	x[12] += x[17];
	x[12] += x[15];
	rr2 = x[1];
	x[1] = x[12] + rr2;
	x[12] = x[14] * c0;
	rr3 = x[16] * c1;
	rr4 = x[18] * c2;
	rr5 = x[20] * c3;
	rr6 = rr0 * c4;
	rr6 += rr5;
	rr6 -= rr4;
	rr6 -= rr3;
	rr6 -= x[12];
	rr6 += x[13];
	rr3 = x[15] * c0;
	rr4 = x[17] * c1;
	rr5 = x[19] * c2;
	x[12] = x[21] * c3;
	rr7 = rr1 * c4;
	rr7 += x[12];
	rr7 -= rr5;
	rr7 -= rr4;
	rr7 -= rr3;
	rr7 += rr2;
	rr3 = x[14] * c4;
	rr4 = x[16] * c2;
	rr5 = x[18] * c0;
	x[12] = x[20] * c1;
	rr8 = rr0 * c3;
	rr8 -= x[12];
	rr8 -= rr5;
	rr8 -= rr4;
	rr8 += rr3;
	rr8 += x[13];
	rr3 = x[15] * c4;
	rr4 = x[17] * c2;
	rr5 = x[19] * c0;
	x[12] = x[21] * c1;
	rr9 = rr1 * c3;
	rr9 -= x[12];
	rr9 -= rr5;
	rr9 -= rr4;
	rr9 += rr3;
	rr9 += rr2;
	rr3 = x[14] * c1;
	rr4 = x[16] * c4;
	rr5 = x[20] * c0;
	x[12] = rr0 * c2;
	x[12] += rr5;
	rr5 = x[18] * c3;
	rr5 -= x[12];
	rr5 += rr4;
	rr5 -= rr3;
	rr5 += x[13];
	rr3 = x[15] * c1;
	rr4 = x[17] * c4;
	x[12] = x[21] * c0;
	rr10 = rr1 * c2;
	rr10 += x[12];
	x[12] = x[19] * c3;
	x[12] -= rr10;
	x[12] += rr4;
	x[12] -= rr3;
	x[12] += rr2;
	rr10 = x[14] * c3;
	rr3 = x[16] * c0;
	rr4 = x[20] * c2;
	rr11 = rr0 * c1;
	rr11 += rr4;
	rr4 = x[18] * c4;
	rr4 -= rr11;
	rr4 -= rr3;
	rr4 += rr10;
	rr4 += x[13];
	rr10 = x[15] * c3;
	rr11 = x[17] * c0;
	rr3 = x[21] * c2;
	rr12 = rr1 * c1;
	rr12 += rr3;
	rr3 = x[19] * c4;
	rr3 -= rr12;
	rr3 -= rr11;
	rr3 += rr10;
	rr3 += rr2;
	x[14] *= c2;
	x[16] *= c3;
	x[18] *= c1;
	rr0 *= c0;
	x[20] *= c4;
	x[20] -= rr0;
	x[20] -= x[18];
	x[20] += x[16];
	x[20] -= x[14];
	x[20] += x[13];
	x[15] *= c2;
	x[17] *= c3;
	x[19] *= c1;
	rr1 *= c0;
	x[21] *= c4;
	x[21] -= rr1;
	x[21] -= x[19];
	x[21] += x[17];
	x[21] -= x[15];
	x[21] += rr2;
	rr0 = x[11] * c5;
	rr1 = x[9] * c6;
	rr10 = x[7] * c7;
	rr11 = x[5] * c8;
	rr12 = x[3] * c9;
	rr12 += rr11;
	rr12 += rr10;
	rr12 += rr1;
	rr12 += rr0;
	rr0 = x[10] * c5;
	rr1 = x[8] * c6;
	rr10 = x[6] * c7;
	rr11 = x[4] * c8;
	rr2 = x[2] * c9;
	rr2 += rr11;
	rr2 += rr10;
	rr2 += rr1;
	rr2 += rr0;
	rr0 = x[5] * c6;
	rr1 = x[3] * c8;
	rr1 += rr0;
	rr0 = x[7] * c5;
	rr0 -= rr1;
	rr1 = x[9] * c7;
	rr1 += rr0;
	rr0 = x[11] * c9;
	rr0 += rr1;
	rr1 = x[4] * c6;
	rr10 = x[2] * c8;
	rr10 += rr1;
	rr1 = x[6] * c5;
	rr1 -= rr10;
	rr10 = x[8] * c7;
	rr10 += rr1;
	rr1 = x[10] * c9;
	rr1 += rr10;
	rr10 = x[11] * c6;
	rr11 = x[9] * c9;
	x[13] = x[3] * c7;
	x[14] = x[5] * c5;
	x[14] -= x[13];
	x[13] = x[7] * c8;
	x[13] += x[14];
	x[13] -= rr11;
	x[13] -= rr10;
	rr10 = x[10] * c6;
	rr11 = x[8] * c9;
	x[14] = x[2] * c7;
	x[15] = x[4] * c5;
	x[15] -= x[14];
	x[14] = x[6] * c8;
	x[14] += x[15];
	x[14] -= rr11;
	x[14] -= rr10;
	rr10 = x[9] * c5;
	rr11 = x[7] * c9;
	x[15] = x[3] * c6;
	x[16] = x[5] * c7;
	x[16] -= x[15];
	x[16] -= rr11;
	x[16] -= rr10;
	rr10 = x[11] * c8;
	rr10 += x[16];
	rr11 = x[8] * c5;
	x[15] = x[6] * c9;
	x[16] = x[2] * c6;
	x[17] = x[4] * c7;
	x[17] -= x[16];
	x[17] -= x[15];
	x[17] -= rr11;
	rr11 = x[10] * c8;
	rr11 += x[17];
	x[11] *= c7;
	x[7] *= c6;
	x[3] *= c5;
	x[5] *= c9;
	x[5] -= x[3];
	x[5] -= x[7];
	x[9] *= c8;
	x[9] += x[5];
	x[9] -= x[11];
	x[10] *= c7;
	x[6] *= c6;
	x[2] *= c5;
	x[4] *= c9;
	x[4] -= x[2];
	x[4] -= x[6];
	x[8] *= c8;
	x[8] += x[4];
	x[8] -= x[10];
	x[2] = rr12 + rr6;
	x[3] = rr7 - rr2;
	x[10] = x[20];
	x[20] = rr6 - rr12;
	rr12 = x[21];
	x[21] = rr2 + rr7;
	x[4] = rr8 - rr0;
	x[5] = rr9 + rr1;
	x[18] = rr8 + rr0;
	x[19] = rr9 - rr1;
	x[6] = rr5 - x[13];
	x[7] = x[12] + x[14];
	x[16] = rr5 + x[13];
	x[17] = x[12] - x[14];
	rr0 = x[8];
	x[8] = rr4 - rr10;
	rr1 = x[9];
	x[9] = rr3 + rr11;
	x[14] = rr4 + rr10;
	x[15] = rr3 - rr11;
	rr10 = x[10];
	x[10] = rr10 - rr1;
	x[11] = rr12 + rr0;
	x[12] = rr10 + rr1;
	x[13] = rr12 - rr0;
}

template<class T>
void fft_complex_12(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 4.99999999999999778e-01;
	const T c1 = 8.66025403784438708e-01;
	rr0 = x[0] + x[12];
	rr1 = x[1] + x[13];
	x[0] -= x[12];
	x[1] -= x[13];
	x[12] = x[6] + x[18];
	x[13] = x[7] + x[19];
	x[6] -= x[18];
	x[7] -= x[19];
	x[18] = rr0 + x[12];
	x[19] = rr1 + x[13];
	rr0 -= x[12];
	rr1 -= x[13];
	x[12] = x[0] + x[7];
	x[13] = x[1] - x[6];
	x[0] -= x[7];
	x[6] += x[1];
	x[1] = x[8] + x[20];
	x[7] = x[9] + x[21];
	x[8] -= x[20];
	x[9] -= x[21];
	x[20] = x[14] + x[2];
	x[21] = x[15] + x[3];
	x[14] -= x[2];
	x[15] -= x[3];
	x[2] = x[1] + x[20];
	x[3] = x[7] + x[21];
	x[1] -= x[20];
	x[7] -= x[21];
	x[20] = x[8] + x[15];
	x[21] = x[9] - x[14];
	x[8] -= x[15];
	x[14] += x[9];
	x[15] = x[16] + x[4];
	x[9] = x[17] + x[5];
	x[16] -= x[4];
	x[17] -= x[5];
	x[4] = x[22] + x[10];
	x[5] = x[23] + x[11];
	x[22] -= x[10];
	x[23] -= x[11];
	x[10] = x[15] + x[4];
	x[11] = x[9] + x[5];
	x[15] -= x[4];
	x[9] -= x[5];
	x[4] = x[16] + x[23];
	x[5] = x[17] - x[22];
	x[16] -= x[23];
	x[22] += x[17];
	x[17] = x[2] + x[10];
	x[23] = x[3] + x[11];
	x[2] -= x[10];
	x[3] -= x[11];
	x[10] = x[0];
	x[0] = x[17] + x[18];
	x[11] = x[1];
	x[1] = x[23] + x[19];
	x[17] *= c0;
	x[18] -= x[17];
	x[23] *= c0;
	x[19] -= x[23];
	x[3] *= c1;
	x[2] *= c1;
	x[17] = x[8];
	x[8] = x[3] + x[18];
	x[23] = x[9];
	x[9] = x[19] - x[2];
	rr2 = x[16];
	x[16] = x[18] - x[3];
	x[18] = x[17];
	x[17] = x[2] + x[19];
	x[19] = x[20] + x[4];
	x[2] = x[21] + x[5];
	x[20] -= x[4];
	x[21] -= x[5];
	x[3] = x[18];
	x[18] = x[19] + x[12];
	x[4] = x[19];
	x[19] = x[2] + x[13];
	x[4] *= c0;
	x[12] -= x[4];
	x[2] *= c0;
	x[13] -= x[2];
	x[21] *= c1;
	x[20] *= c1;
	x[2] = x[21] + x[12];
	x[4] = x[3];
	x[3] = x[13] - x[20];
	x[5] = x[10];
	x[10] = x[12] - x[21];
	x[12] = x[11];
	x[11] = x[20] + x[13];
	x[13] = x[12] + x[15];
	x[20] = x[7] + x[23];
	x[12] -= x[15];
	x[7] -= x[23];
	x[15] = x[12];
	x[12] = x[13] + rr0;
	x[21] = x[13];
	x[13] = x[20] + rr1;
	x[21] *= c0;
	rr0 -= x[21];
	x[20] *= c0;
	rr1 -= x[20];
	x[7] *= c1;
	x[15] *= c1;
	x[20] = x[7] + rr0;
	x[21] = rr1 - x[15];
	x[23] = x[4];
	x[4] = rr0 - x[7];
	rr0 = x[5];
	x[5] = x[15] + rr1;
	rr1 = x[23] + rr2;
	x[15] = x[14] + x[22];
	x[23] -= rr2;
	x[14] -= x[22];
	rr2 = x[6];
	x[6] = rr1 + rr0;
	x[7] = x[15] + rr2;
	rr1 *= c0;
	rr0 -= rr1;
	x[15] *= c0;
	rr2 -= x[15];
	x[14] *= c1;
	x[23] *= c1;
	rr1 = x[14];
	x[14] = rr1 + rr0;
	x[15] = rr2 - x[23];
	x[22] = rr0 - rr1;
	rr0 = x[23];
	x[23] = rr0 + rr2;
}

template<class T>
void fft_complex_13(T* x) {
	T rr0;
	T rr1;
	T rr2;
	T rr3;
	T rr4;
	T rr5;
	T rr6;
	T rr7;
	T rr8;
	T rr9;
	T rr10;
	T rr11;
	T rr12;
	T rr13;
	T rr14;
	T rr15;
	T rr16;
	T rr17;
	T rr18;
	T rr19;
	T rr20;
	T rr21;
	T rr22;
	T rr23;
	const T c0 = 8.33333333333334397e-02;
	const T c1 = 2.75828074752184849e-01;
	const T c2 = 4.27634046826572578e-01;
	const T c3 = 1.00707406572753300e+00;
	const T c4 = 5.24226639526581994e-01;
	const T c5 = 1.04074742015007171e+00;
	const T c6 = 3.00462606288665890e-01;
	const T c7 = 5.31932498429674272e-01;
	const T c8 = 4.01002128321867213e-01;
	const T c9 = 3.68124494401423918e-01;
	const T c10 = 5.70727136526264500e-01;
	const T c11 = 1.34405691517736958e+00;
	const T c12 = 6.87846909707147125e-01;
	const T c13 = 1.06641340936557172e+00;
	const T c14 = 7.49279330626139051e-01;
	const T c15 = 2.51139331838956803e+00;
	const T c16 = 5.27985702054285522e-01;
	const T c17 = 8.18570272945918109e-01;
	const T c18 = 1.74138601152135891e-01;
	const T c19 = 1.92772511678346881e+00;
	rr0 = x[0] + x[2];
	rr0 += x[4];
	rr0 += x[6];
	rr0 += x[8];
	rr0 += x[10];
	rr0 += x[12];
	rr0 += x[14];
	rr0 += x[16];
	rr0 += x[18];
	rr0 += x[20];
	rr0 += x[22];
	rr1 = x[0];
	x[0] = rr0 + x[24];
	rr0 = x[1] + x[3];
	rr0 += x[5];
	rr0 += x[7];
	rr0 += x[9];
	rr0 += x[11];
	rr0 += x[13];
	rr0 += x[15];
	rr0 += x[17];
	rr0 += x[19];
	rr0 += x[21];
	rr0 += x[23];
	rr2 = x[1];
	x[1] = rr0 + x[25];
	rr0 = x[14] + x[12];
	rr3 = x[18] + x[8];
	rr4 = rr3 + rr0;
	rr5 = x[22] + x[4];
	rr6 = x[6] + x[20];
	rr7 = rr6 + rr5;
	rr8 = x[16] + x[10];
	rr9 = x[2] + x[24];
	rr10 = rr9 + rr8;
	rr11 = rr10 + rr7;
	rr11 += rr4;
	rr11 *= c0;
	rr10 -= rr4;
	rr12 = rr10 * c1;
	rr7 -= rr4;
	rr10 += rr7;
	rr10 *= c2;
	rr12 = rr10 - rr12;
	rr4 = rr12 - rr11;
	rr13 = x[15] + x[13];
	rr14 = x[19] + x[9];
	rr15 = rr14 + rr13;
	rr16 = x[23] + x[5];
	rr17 = x[7] + x[21];
	rr18 = rr17 + rr16;
	rr19 = x[17] + x[11];
	rr20 = x[3] + x[25];
	rr21 = rr20 + rr19;
	rr22 = rr21 + rr18;
	rr22 += rr15;
	rr22 *= c0;
	rr21 -= rr15;
	rr23 = rr21 * c1;
	rr18 -= rr15;
	rr21 += rr18;
	rr21 *= c2;
	rr23 = rr21 - rr23;
	rr15 = rr23 - rr22;
	rr7 *= c3;
	rr10 -= rr7;
	rr12 += rr11;
	rr12 += rr10;
	rr18 *= c3;
	rr21 -= rr18;
	rr23 += rr22;
	rr23 += rr21;
	rr10 -= rr11;
	rr21 -= rr22;
	rr3 -= rr0;
	rr6 -= rr5;
	rr0 = rr6 - rr3;
	rr9 -= rr8;
	rr11 = rr9 - rr3;
	rr18 = rr11 + rr0;
	rr18 *= c4;
	rr11 *= c5;
	rr11 -= rr18;
	rr9 += rr6;
	rr9 += rr3;
	rr9 *= c6;
	rr22 = rr9 + rr11;
	rr14 -= rr13;
	rr17 -= rr16;
	rr13 = rr17 - rr14;
	rr20 -= rr19;
	rr16 = rr20 - rr14;
	rr19 = rr16 + rr13;
	rr19 *= c4;
	rr16 *= c5;
	rr16 -= rr19;
	rr20 += rr17;
	rr20 += rr14;
	rr20 *= c6;
	rr14 = rr20 + rr16;
	rr0 *= c7;
	rr0 -= rr18;
	rr11 = rr9 - rr11;
	rr11 -= rr0;
	rr13 *= c7;
	rr13 -= rr19;
	rr16 = rr20 - rr16;
	rr16 -= rr13;
	rr9 += rr0;
	rr20 += rr13;
	x[19] -= x[9];
	x[7] -= x[21];
	x[3] -= x[25];
	rr0 = x[3] + x[7];
	rr0 += x[19];
	rr0 *= c8;
	rr13 = x[3] - x[19];
	rr17 = rr13 * c9;
	rr18 = x[7] - x[19];
	rr13 += rr18;
	rr13 *= c10;
	rr17 = rr13 - rr17;
	rr19 = rr17 - rr0;
	x[18] -= x[8];
	x[6] -= x[20];
	rr3 = x[6] - x[18];
	x[2] -= x[24];
	rr5 = x[2] - x[18];
	rr6 = rr5 + rr3;
	rr6 *= c10;
	rr5 *= c9;
	rr5 -= rr6;
	rr7 = x[2] + x[6];
	rr7 += x[18];
	rr7 *= c8;
	rr8 = rr7 + rr5;
	rr18 *= c11;
	rr13 -= rr18;
	rr17 += rr0;
	rr17 += rr13;
	rr3 *= c11;
	rr3 -= rr6;
	rr5 = rr7 - rr5;
	rr5 -= rr3;
	rr13 -= rr0;
	rr7 += rr3;
	x[15] -= x[13];
	x[17] -= x[11];
	rr0 = x[17] - x[15];
	rr18 = rr0 * c12;
	x[23] -= x[5];
	rr3 = x[23] - x[15];
	rr0 += rr3;
	rr0 *= c13;
	rr18 = rr0 - rr18;
	rr6 = x[17] + x[23];
	rr6 += x[15];
	rr6 *= c14;
	x[11] = rr6 + rr18;
	x[14] -= x[12];
	x[22] -= x[4];
	x[16] -= x[10];
	x[10] = x[16] + x[22];
	x[10] += x[14];
	x[10] *= c14;
	x[12] = x[22] - x[14];
	x[13] = x[16] - x[14];
	x[20] = x[13] + x[12];
	x[20] *= c13;
	x[13] *= c12;
	x[13] -= x[20];
	x[21] = x[13] - x[10];
	rr3 *= c15;
	rr0 -= rr3;
	rr18 = rr6 - rr18;
	rr18 -= rr0;
	x[12] *= c15;
	x[12] -= x[20];
	x[13] += x[10];
	x[13] += x[12];
	rr6 += rr0;
	x[12] -= x[10];
	x[19] += x[15];
	x[3] += x[17];
	rr0 = x[3] - x[19];
	rr3 = rr0 * c16;
	x[7] += x[23];
	x[10] = x[7] - x[19];
	rr0 += x[10];
	rr0 *= c17;
	rr3 = rr0 - rr3;
	x[3] += x[7];
	x[3] += x[19];
	x[3] *= c18;
	x[15] = x[3] + rr3;
	x[18] += x[14];
	x[6] += x[22];
	x[2] += x[16];
	x[14] = x[2] + x[6];
	x[14] += x[18];
	x[14] *= c18;
	x[6] -= x[18];
	x[2] -= x[18];
	x[16] = x[2] + x[6];
	x[16] *= c17;
	x[2] *= c16;
	x[2] -= x[16];
	x[17] = x[2] - x[14];
	x[10] *= c19;
	rr0 -= x[10];
	rr3 = x[3] - rr3;
	rr3 -= rr0;
	x[6] *= c19;
	x[6] -= x[16];
	x[2] += x[14];
	x[2] += x[6];
	x[3] += rr0;
	x[6] -= x[14];
	x[11] = x[15] - x[11];
	rr0 = rr4 + rr22;
	x[10] = rr0 + x[11];
	x[21] = x[17] - x[21];
	x[14] = rr15 + rr14;
	x[16] = x[14] + x[21];
	rr18 = rr3 - rr18;
	x[18] = rr11 - rr12;
	x[19] = x[18] + rr18;
	x[13] -= x[2];
	x[20] = rr16 - rr23;
	x[22] = x[20] + x[13];
	rr6 = x[3] - rr6;
	x[23] = rr10 + rr9;
	x[24] = x[23] + rr6;
	x[12] = x[6] - x[12];
	x[25] = rr21 + rr20;
	x[4] = x[25] + x[12];
	x[15] -= rr19;
	rr4 -= rr22;
	rr19 = rr4 + x[15];
	x[17] -= rr8;
	rr15 -= rr14;
	rr14 = rr15 + x[17];
	rr12 += rr11;
	rr17 += rr3;
	rr11 = rr17 - rr12;
	x[2] += rr5;
	rr23 += rr16;
	rr16 = rr23 + x[2];
	x[3] -= rr13;
	rr10 -= rr9;
	rr13 = rr10 + x[3];
	x[6] -= rr7;
	rr21 -= rr20;
	rr20 = rr21 + x[6];
	rr0 -= x[11];
	x[14] -= x[21];
	x[18] -= rr18;
	x[20] -= x[13];
	x[23] -= rr6;
	x[25] -= x[12];
	rr4 -= x[15];
	rr15 -= x[17];
	rr12 += rr17;
	x[2] -= rr23;
	rr10 -= x[3];
	rr21 -= x[6];
	rr17 = x[2];
	x[2] = rr1 + x[10];
	x[3] = rr2 + x[16];
	rr18 = x[14];
	x[14] = rr1 - rr12;
	x[15] = rr2 + rr17;
	rr12 = x[20];
	x[20] = rr1 + x[23];
	x[21] = rr2 + x[25];
	x[10] = rr1 + rr19;
	x[11] = rr2 + rr14;
	rr14 = x[18];
	x[18] = rr1 + x[19];
	x[19] = rr2 + x[22];
	x[22] = rr1 + rr10;
	x[23] = rr2 + rr21;
	rr10 = x[24];
	x[24] = rr1 + rr0;
	x[25] = rr2 + rr18;
	x[12] = rr1 + rr11;
	x[13] = rr2 - rr16;
	x[6] = rr1 + rr10;
	x[7] = rr2 + x[4];
	x[16] = rr1 + rr4;
	x[17] = rr2 + rr15;
	x[8] = rr1 + rr14;
	x[9] = rr2 + rr12;
	x[4] = rr1 + rr13;
	x[5] = rr2 + rr20;
}

template<class T>
void fft_complex_14(T* x) {
	T rr0;
	T rr1;
	T rr2;
	T rr3;
	T rr4;
	T rr5;
	T rr6;
	const T c0 = 9.00968867902419035e-01;
	const T c1 = 2.22520933956314337e-01;
	const T c2 = 6.23489801858733594e-01;
	const T c3 = 4.33883739117558231e-01;
	const T c4 = 9.74927912181823619e-01;
	const T c5 = 7.81831482468029804e-01;
	rr0 = x[4] + x[24];
	rr1 = x[5] + x[25];
	x[4] -= x[24];
	x[5] -= x[25];
	x[24] = x[8] + x[20];
	x[25] = x[9] + x[21];
	x[8] -= x[20];
	x[9] -= x[21];
	x[20] = x[12] + x[16];
	x[21] = x[13] + x[17];
	x[12] -= x[16];
	x[13] -= x[17];
	x[16] = rr0 + x[24];
	x[16] += x[20];
	x[16] += x[0];
	x[17] = rr1 + x[25];
	x[17] += x[21];
	x[17] += x[1];
	rr2 = x[20] * c0;
	rr3 = x[24] * c1;
	rr4 = rr0 * c2;
	rr4 -= rr3;
	rr4 -= rr2;
	rr4 += x[0];
	rr2 = x[21] * c0;
	rr3 = x[25] * c1;
	rr5 = rr1 * c2;
	rr5 -= rr3;
	rr5 -= rr2;
	rr5 += x[1];
	rr2 = x[24] * c0;
	rr3 = rr0 * c1;
	rr3 += rr2;
	rr2 = x[20] * c2;
	rr2 -= rr3;
	rr2 += x[0];
	rr3 = x[25] * c0;
	rr6 = rr1 * c1;
	rr6 += rr3;
	rr3 = x[21] * c2;
	rr3 -= rr6;
	rr3 += x[1];
	x[20] *= c1;
	rr0 *= c0;
	x[24] *= c2;
	x[24] -= rr0;
	x[24] -= x[20];
	x[24] += x[0];
	x[21] *= c1;
	rr1 *= c0;
	x[25] *= c2;
	x[25] -= rr1;
	x[25] -= x[21];
	x[25] += x[1];
	rr0 = x[13] * c3;
	rr1 = x[9] * c4;
	rr6 = x[5] * c5;
	rr6 += rr1;
	rr6 += rr0;
	rr0 = x[12] * c3;
	rr1 = x[8] * c4;
	x[0] = x[4] * c5;
	x[0] += rr1;
	x[0] += rr0;
	rr0 = x[5] * c4;
	rr1 = x[9] * c3;
	rr1 -= rr0;
	rr0 = x[13] * c5;
	rr0 += rr1;
	rr1 = x[4] * c4;
	x[1] = x[8] * c3;
	x[1] -= rr1;
	rr1 = x[12] * c5;
	rr1 += x[1];
	x[13] *= c4;
	x[5] *= c3;
	x[9] *= c5;
	x[9] -= x[5];
	x[9] -= x[13];
	x[12] *= c4;
	x[4] *= c3;
	x[8] *= c5;
	x[8] -= x[4];
	x[8] -= x[12];
	x[12] = rr6 + rr4;
	x[13] = rr5 - x[0];
	rr4 -= rr6;
	x[0] += rr5;
	rr5 = rr2 - rr0;
	rr6 = rr3 + rr1;
	rr2 += rr0;
	rr3 -= rr1;
	rr0 = x[24] - x[9];
	rr1 = x[25] + x[8];
	x[24] += x[9];
	x[25] -= x[8];
	x[1] = x[18] + x[10];
	x[20] = x[19] + x[11];
	x[18] -= x[10];
	x[19] -= x[11];
	x[10] = x[22] + x[6];
	x[11] = x[23] + x[7];
	x[22] -= x[6];
	x[23] -= x[7];
	x[21] = x[26] + x[2];
	x[4] = x[27] + x[3];
	x[26] -= x[2];
	x[27] -= x[3];
	x[2] = x[1] + x[10];
	x[2] += x[21];
	x[2] += x[14];
	x[3] = x[20] + x[11];
	x[3] += x[4];
	x[3] += x[15];
	x[5] = x[21] * c0;
	x[6] = x[10] * c1;
	x[7] = x[1] * c2;
	x[7] -= x[6];
	x[7] -= x[5];
	x[7] += x[14];
	x[5] = x[4] * c0;
	x[6] = x[11] * c1;
	x[8] = x[20] * c2;
	x[8] -= x[6];
	x[8] -= x[5];
	x[8] += x[15];
	x[5] = x[10] * c0;
	x[6] = x[1] * c1;
	x[6] += x[5];
	x[5] = x[21] * c2;
	x[5] -= x[6];
	x[5] += x[14];
	x[6] = x[11] * c0;
	x[9] = x[20] * c1;
	x[9] += x[6];
	x[6] = x[4] * c2;
	x[6] -= x[9];
	x[6] += x[15];
	x[21] *= c1;
	x[1] *= c0;
	x[10] *= c2;
	x[10] -= x[1];
	x[10] -= x[21];
	x[10] += x[14];
	x[4] *= c1;
	x[20] *= c0;
	x[11] *= c2;
	x[11] -= x[20];
	x[11] -= x[4];
	x[11] += x[15];
	x[14] = x[27] * c3;
	x[15] = x[23] * c4;
	x[1] = x[19] * c5;
	x[1] += x[15];
	x[1] += x[14];
	x[14] = x[26] * c3;
	x[15] = x[22] * c4;
	x[20] = x[18] * c5;
	x[20] += x[15];
	x[20] += x[14];
	x[14] = x[19] * c4;
	x[15] = x[23] * c3;
	x[15] -= x[14];
	x[14] = x[27] * c5;
	x[14] += x[15];
	x[15] = x[18] * c4;
	x[21] = x[22] * c3;
	x[21] -= x[15];
	x[15] = x[26] * c5;
	x[15] += x[21];
	x[27] *= c4;
	x[19] *= c3;
	x[23] *= c5;
	x[23] -= x[19];
	x[23] -= x[27];
	x[26] *= c4;
	x[18] *= c3;
	x[22] *= c5;
	x[22] -= x[18];
	x[22] -= x[26];
	x[18] = x[1] + x[7];
	x[19] = x[8] - x[20];
	x[7] -= x[1];
	x[20] += x[8];
	x[1] = x[5] - x[14];
	x[21] = x[6] + x[15];
	x[5] += x[14];
	x[6] -= x[15];
	x[14] = x[10] - x[23];
	x[15] = x[11] + x[22];
	x[10] += x[23];
	x[11] -= x[22];
	x[22] = x[0];
	x[0] = x[16] + x[2];
	x[23] = x[1];
	x[1] = x[17] + x[3];
	x[26] = x[14];
	x[14] = x[16] - x[2];
	x[16] = x[15];
	x[15] = x[17] - x[3];
	x[17] = x[16];
	x[16] = x[12] + x[18];
	x[27] = x[17];
	x[17] = x[13] + x[19];
	x[2] = x[12] - x[18];
	x[3] = x[13] - x[19];
	x[4] = rr5 + x[23];
	x[12] = x[5];
	x[5] = rr6 + x[21];
	x[18] = rr5 - x[23];
	x[19] = rr6 - x[21];
	rr5 = x[20];
	x[20] = rr0 + x[26];
	x[21] = rr1 + x[27];
	rr6 = x[6];
	x[6] = rr0 - x[26];
	rr0 = x[7];
	x[7] = rr1 - x[27];
	x[8] = x[24] + x[10];
	x[9] = x[25] + x[11];
	rr1 = x[22];
	x[22] = x[24] - x[10];
	x[23] = x[25] - x[11];
	x[24] = rr2 + x[12];
	x[25] = rr3 + rr6;
	x[10] = rr2 - x[12];
	x[11] = rr3 - rr6;
	x[12] = rr4 + rr0;
	x[13] = rr1 + rr5;
	x[26] = rr4 - rr0;
	x[27] = rr1 - rr5;
}

template<class T>
void fft_complex_15(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 5.59016994374947451e-01;
	const T c1 = 2.49999999999999944e-01;
	const T c2 = 5.87785252292473248e-01;
	const T c3 = 9.51056516295153531e-01;
	const T c4 = 4.99999999999999778e-01;
	const T c5 = 8.66025403784438708e-01;
	rr0 = x[6] + x[24];
	rr1 = x[7] + x[25];
	x[6] -= x[24];
	x[7] -= x[25];
	x[24] = x[12] + x[18];
	x[25] = x[13] + x[19];
	x[12] -= x[18];
	x[13] -= x[19];
	x[18] = rr0 - x[24];
	x[18] *= c0;
	rr0 += x[24];
	x[19] = rr0 * c1;
	x[19] = x[0] - x[19];
	x[24] = x[19] + x[18];
	x[19] -= x[18];
	x[18] = rr1 - x[25];
	x[18] *= c0;
	rr1 += x[25];
	x[25] = rr1 * c1;
	x[25] = x[1] - x[25];
	rr2 = x[25] + x[18];
	x[25] -= x[18];
	rr0 += x[0];
	rr1 += x[1];
	x[0] = x[13] * c2;
	x[18] = x[7] * c3;
	x[18] += x[0];
	x[0] = x[12] * c2;
	x[1] = x[6] * c3;
	x[1] += x[0];
	x[7] *= c2;
	x[13] *= c3;
	x[13] -= x[7];
	x[6] *= c2;
	x[12] *= c3;
	x[12] -= x[6];
	x[0] = x[18] + x[24];
	x[6] = rr2 - x[1];
	x[24] -= x[18];
	x[1] += rr2;
	rr2 = x[19] - x[13];
	x[18] = x[25] + x[12];
	x[19] += x[13];
	x[25] -= x[12];
	x[12] = x[16] + x[4];
	x[13] = x[17] + x[5];
	x[16] -= x[4];
	x[17] -= x[5];
	x[4] = x[22] + x[28];
	x[5] = x[23] + x[29];
	x[22] -= x[28];
	x[23] -= x[29];
	x[28] = x[12] - x[4];
	x[28] *= c0;
	x[12] += x[4];
	x[29] = x[12] * c1;
	x[29] = x[10] - x[29];
	x[4] = x[29] + x[28];
	x[29] -= x[28];
	x[28] = x[13] - x[5];
	x[28] *= c0;
	x[13] += x[5];
	x[5] = x[13] * c1;
	x[5] = x[11] - x[5];
	x[7] = x[5] + x[28];
	x[5] -= x[28];
	x[12] += x[10];
	x[13] += x[11];
	x[10] = x[23] * c2;
	x[11] = x[17] * c3;
	x[11] += x[10];
	x[10] = x[22] * c2;
	x[28] = x[16] * c3;
	x[28] += x[10];
	x[17] *= c2;
	x[23] *= c3;
	x[23] -= x[17];
	x[16] *= c2;
	x[22] *= c3;
	x[22] -= x[16];
	x[10] = x[11] + x[4];
	x[16] = x[7] - x[28];
	x[4] -= x[11];
	x[28] += x[7];
	x[11] = x[29] - x[23];
	x[17] = x[5] + x[22];
	x[29] += x[23];
	x[5] -= x[22];
	x[22] = x[26] + x[14];
	x[23] = x[27] + x[15];
	x[26] -= x[14];
	x[27] -= x[15];
	x[14] = x[2] + x[8];
	x[15] = x[3] + x[9];
	x[2] -= x[8];
	x[3] -= x[9];
	x[7] = x[22] - x[14];
	x[7] *= c0;
	x[22] += x[14];
	x[14] = x[22] * c1;
	x[14] = x[20] - x[14];
	x[8] = x[14] + x[7];
	x[14] -= x[7];
	x[7] = x[23] - x[15];
	x[7] *= c0;
	x[23] += x[15];
	x[15] = x[23] * c1;
	x[15] = x[21] - x[15];
	x[9] = x[15] + x[7];
	x[15] -= x[7];
	x[22] += x[20];
	x[23] += x[21];
	x[20] = x[3] * c2;
	x[21] = x[27] * c3;
	x[21] += x[20];
	x[20] = x[2] * c2;
	x[7] = x[26] * c3;
	x[7] += x[20];
	x[27] *= c2;
	x[3] *= c3;
	x[3] -= x[27];
	x[26] *= c2;
	x[2] *= c3;
	x[2] -= x[26];
	x[20] = x[21] + x[8];
	x[26] = x[9] - x[7];
	x[8] -= x[21];
	x[7] += x[9];
	x[21] = x[14] - x[3];
	x[27] = x[15] + x[2];
	x[14] += x[3];
	x[15] -= x[2];
	x[2] = x[12] + x[22];
	x[3] = x[13] + x[23];
	x[12] -= x[22];
	x[13] -= x[23];
	x[22] = x[0];
	x[0] = x[2] + rr0;
	x[23] = x[1];
	x[1] = x[3] + rr1;
	x[2] *= c4;
	rr0 -= x[2];
	x[3] *= c4;
	rr1 -= x[3];
	x[13] *= c5;
	x[12] *= c5;
	x[2] = x[20];
	x[20] = x[13] + rr0;
	x[3] = x[21];
	x[21] = rr1 - x[12];
	x[9] = x[10];
	x[10] = rr0 - x[13];
	rr0 = x[11];
	x[11] = x[12] + rr1;
	rr1 = x[9] + x[2];
	x[12] = x[16] + x[26];
	x[9] -= x[2];
	x[16] -= x[26];
	x[13] = x[12];
	x[12] = rr1 + x[22];
	x[26] = x[13];
	x[13] = x[26] + x[6];
	rr1 *= c4;
	x[22] -= rr1;
	x[26] *= c4;
	x[6] -= x[26];
	x[16] *= c5;
	x[9] *= c5;
	x[2] = x[16] + x[22];
	rr1 = x[3];
	x[3] = x[6] - x[9];
	x[26] = x[22];
	x[22] = x[26] - x[16];
	x[16] = x[23];
	x[23] = x[9] + x[6];
	x[26] = rr0 + rr1;
	x[6] = x[17] + x[27];
	rr0 -= rr1;
	x[17] -= x[27];
	rr1 = x[24];
	x[24] = x[26] + rr2;
	x[27] = x[25];
	x[25] = x[6] + x[18];
	x[26] *= c4;
	rr2 -= x[26];
	x[6] *= c4;
	x[18] -= x[6];
	x[17] *= c5;
	rr0 *= c5;
	x[26] = x[14];
	x[14] = x[17] + rr2;
	x[6] = x[15];
	x[15] = x[18] - rr0;
	x[9] = x[4];
	x[4] = rr2 - x[17];
	rr2 = x[5];
	x[5] = rr0 + x[18];
	rr0 = x[29] + x[26];
	x[17] = rr2 + x[6];
	x[29] -= x[26];
	rr2 -= x[6];
	x[6] = rr0 + x[19];
	x[18] = x[7];
	x[7] = x[17] + x[27];
	rr0 *= c4;
	x[19] -= rr0;
	x[17] *= c4;
	x[27] -= x[17];
	rr2 *= c5;
	x[29] *= c5;
	x[26] = rr2 + x[19];
	rr0 = x[27];
	x[27] = rr0 - x[29];
	x[17] = x[16];
	x[16] = x[19] - rr2;
	rr2 = x[17];
	x[17] = x[29] + rr0;
	rr0 = x[9] + x[8];
	x[19] = x[28] + x[18];
	x[9] -= x[8];
	x[28] -= x[18];
	x[18] = rr0 + rr1;
	x[29] = x[19];
	x[19] = x[29] + rr2;
	rr0 *= c4;
	rr1 -= rr0;
	x[29] *= c4;
	rr2 -= x[29];
	x[28] *= c5;
	x[9] *= c5;
	x[8] = x[28] + rr1;
	rr0 = x[9];
	x[9] = rr2 - rr0;
	x[29] = x[28];
	x[28] = rr1 - x[29];
	x[29] = rr0 + rr2;
}

template<class T>
void fft_complex_16(T* x) {
	T rr0;
	T rr1;
	T rr2;
	const T c0 = 9.23879532511286738e-01;
	const T c1 = 3.82683432365089782e-01;
	const T c2 = 7.07106781186547573e-01;
	rr0 = x[0] + x[16];
	rr1 = x[1] + x[17];
	x[0] -= x[16];
	x[1] -= x[17];
	x[16] = x[8] + x[24];
	x[17] = x[9] + x[25];
	x[8] -= x[24];
	x[9] -= x[25];
	x[24] = rr0 + x[16];
	x[25] = rr1 + x[17];
	rr0 -= x[16];
	rr1 -= x[17];
	x[16] = x[0] + x[9];
	x[17] = x[1] - x[8];
	x[0] -= x[9];
	x[8] += x[1];
	x[1] = x[2] + x[18];
	x[9] = x[3] + x[19];
	x[2] -= x[18];
	x[3] -= x[19];
	x[18] = x[10] + x[26];
	x[19] = x[11] + x[27];
	x[10] -= x[26];
	x[11] -= x[27];
	x[26] = x[1] + x[18];
	x[27] = x[9] + x[19];
	x[1] -= x[18];
	x[9] -= x[19];
	x[18] = x[2] + x[11];
	x[19] = x[3] - x[10];
	x[2] -= x[11];
	x[10] += x[3];
	x[11] = x[4] + x[20];
	x[3] = x[5] + x[21];
	x[4] -= x[20];
	x[5] -= x[21];
	x[20] = x[12] + x[28];
	x[21] = x[13] + x[29];
	x[12] -= x[28];
	x[13] -= x[29];
	x[28] = x[11] + x[20];
	x[29] = x[3] + x[21];
	x[11] -= x[20];
	x[3] -= x[21];
	x[20] = x[4] + x[13];
	x[21] = x[5] - x[12];
	x[4] -= x[13];
	x[12] += x[5];
	x[13] = x[6] + x[22];
	x[5] = x[7] + x[23];
	x[6] -= x[22];
	x[7] -= x[23];
	x[22] = x[14] + x[30];
	x[23] = x[15] + x[31];
	x[14] -= x[30];
	x[15] -= x[31];
	x[30] = x[13] + x[22];
	x[31] = x[5] + x[23];
	x[13] -= x[22];
	x[5] -= x[23];
	x[22] = x[6] + x[15];
	x[23] = x[7] - x[14];
	x[6] -= x[15];
	x[14] += x[7];
	x[15] = x[18] * c0;
	x[7] = x[19] * c1;
	x[7] += x[15];
	x[18] *= c1;
	x[19] *= c0;
	x[19] -= x[18];
	x[1] *= c2;
	x[9] *= c2;
	x[15] = x[9] + x[1];
	x[9] -= x[1];
	x[18] = x[2] * c1;
	x[1] = x[10] * c0;
	x[1] += x[18];
	x[2] *= c0;
	x[10] *= c1;
	x[10] -= x[2];
	x[20] *= c2;
	x[21] *= c2;
	x[18] = x[21] + x[20];
	x[21] -= x[20];
	x[4] *= c2;
	x[12] *= c2;
	x[20] = x[12] - x[4];
	x[4] += x[12];
	x[12] = x[22] * c1;
	x[2] = x[23] * c0;
	x[2] += x[12];
	x[22] *= c0;
	x[23] *= c1;
	x[23] -= x[22];
	x[13] *= c2;
	x[5] *= c2;
	x[12] = x[5] - x[13];
	x[13] += x[5];
	x[22] = x[14] * c1;
	x[5] = x[6] * c0;
	x[5] += x[22];
	x[14] *= c0;
	x[6] *= c1;
	x[6] -= x[14];
	x[14] = x[24] + x[28];
	x[22] = x[25] + x[29];
	x[24] -= x[28];
	x[25] -= x[29];
	x[28] = x[26] + x[30];
	x[29] = x[27] + x[31];
	x[26] -= x[30];
	x[27] -= x[31];
	x[30] = x[0];
	x[0] = x[14] + x[28];
	x[31] = x[1];
	x[1] = x[22] + x[29];
	rr2 = x[16];
	x[16] = x[14] - x[28];
	x[14] = x[17];
	x[17] = x[22] - x[29];
	x[22] = x[8];
	x[8] = x[24] + x[27];
	x[28] = x[9];
	x[9] = x[25] - x[26];
	x[29] = x[24];
	x[24] = x[29] - x[27];
	x[27] = x[25];
	x[25] = x[26] + x[27];
	x[26] = rr2 + x[18];
	x[27] = x[14] + x[21];
	rr2 -= x[18];
	x[14] -= x[21];
	x[18] = x[7] + x[2];
	x[21] = x[19] + x[23];
	x[7] -= x[2];
	x[19] -= x[23];
	x[2] = x[26] + x[18];
	x[23] = x[3];
	x[3] = x[27] + x[21];
	x[29] = x[18];
	x[18] = x[26] - x[29];
	x[26] = x[19];
	x[19] = x[27] - x[21];
	x[21] = x[10];
	x[10] = rr2 + x[26];
	x[27] = x[11];
	x[11] = x[14] - x[7];
	x[29] = x[26];
	x[26] = rr2 - x[29];
	rr2 = x[27];
	x[27] = x[7] + x[14];
	x[14] = rr0 + x[23];
	x[29] = rr1 - rr2;
	rr0 -= x[23];
	rr2 += rr1;
	rr1 = x[15] + x[12];
	x[23] = x[28] - x[13];
	x[15] -= x[12];
	x[13] += x[28];
	x[12] = x[4];
	x[4] = x[14] + rr1;
	x[28] = x[5];
	x[5] = x[29] + x[23];
	x[7] = x[20];
	x[20] = x[14] - rr1;
	rr1 = x[21];
	x[21] = x[29] - x[23];
	x[14] = x[12];
	x[12] = rr0 + x[13];
	x[23] = x[13];
	x[13] = rr2 - x[15];
	x[29] = x[28];
	x[28] = rr0 - x[23];
	rr0 = x[29];
	x[29] = x[15] + rr2;
	rr2 = x[30] + x[7];
	x[15] = x[22] - x[14];
	x[30] -= x[7];
	x[14] += x[22];
	x[22] = x[31] - rr0;
	x[23] = rr1 + x[6];
	rr0 += x[31];
	rr1 -= x[6];
	x[6] = rr2 + x[22];
	x[7] = x[15] + x[23];
	x[31] = x[22];
	x[22] = rr2 - x[31];
	rr2 = x[23];
	x[23] = x[15] - rr2;
	rr2 = x[14];
	x[14] = x[30] + rr1;
	x[15] = rr2 - rr0;
	x[31] = x[30];
	x[30] = x[31] - rr1;
	x[31] = rr0 + rr2;
}

template<class T>
inline void sfft_complex(T* x, int N) {
	switch (N) {
	case 0:
	case 1:
		break;
	case 2:
		fft_complex_2(x);
		break;
	case 3:
		fft_complex_3(x);
		break;
	case 4:
		fft_complex_4(x);
		break;
	case 5:
		fft_complex_5(x);
		break;
	case 6:
		fft_complex_6(x);
		break;
	case 7:
		fft_complex_7(x);
		break;
	case 8:
		fft_complex_8(x);
		break;
	case 9:
		fft_complex_9(x);
		break;
	case 10:
		fft_complex_10(x);
		break;
	case 11:
		fft_complex_11(x);
		break;
	case 12:
		fft_complex_12(x);
		break;
	case 13:
		fft_complex_13(x);
		break;
	case 14:
		fft_complex_14(x);
		break;
	case 15:
		fft_complex_15(x);
		break;
	case 16:
		fft_complex_16(x);
		break;
	default:
		assert(false);
	}
}
